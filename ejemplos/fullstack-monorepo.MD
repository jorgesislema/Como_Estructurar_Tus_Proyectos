
# Ejemplo: Monorepo Fullstack Moderno (Turborepo, PNPM, React, Node.js)

¬°Bienvenido/a a la plantilla de ejemplo de un monorepo fullstack! Este repositorio demuestra c√≥mo estructurar y gestionar un proyecto que contiene m√∫ltiples aplicaciones (como un frontend web y una API backend) y librer√≠as compartidas, todo dentro de un √∫nico repositorio Git.

## ¬øQu√© es un Monorepo y Por Qu√© Usarlo? ü§î

Un **monorepo** es una estrategia de control de versiones donde el c√≥digo de muchos proyectos relacionados vive en el mismo repositorio. Contrasta con el enfoque *polyrepo* (un repositorio por proyecto).

**Ventajas:**

* **C√≥digo Compartido Simplificado:** F√°cil de crear y consumir librer√≠as/tipos compartidos (`packages/shared-types`) entre el frontend y el backend.
* **Cambios At√≥micos:** Un solo commit/PR puede abarcar cambios coordinados en el frontend, backend y librer√≠as compartidas.
* **Refactorizaci√≥n m√°s Sencilla:** Mover c√≥digo entre paquetes o renombrar interfaces compartidas es m√°s directo.
* **Consistencia de Tooling:** M√°s f√°cil aplicar linters, formateadores y configuraciones de TypeScript de forma uniforme en todo el proyecto.
* **Gesti√≥n de Dependencias Centralizada (Parcial):** Aunque cada paquete tiene sus dependencias, herramientas como PNPM optimizan el almacenamiento y enlazado.

**Desaf√≠os (¬°Abordados aqu√≠!):**

* **Tooling Complejo:** Se necesitan herramientas espec√≠ficas para gestionar dependencias y ejecutar tareas eficientemente. (Usamos **PNPM Workspaces** y **Turborepo**).
* **Tiempos de Build/Test Largos:** Sin optimizaci√≥n, construir/testear todo en cada cambio es lento. (**Turborepo** soluciona esto con cacheo inteligente).
* **Control de Acceso:** Puede ser m√°s complejo si diferentes equipos necesitan permisos distintos (m√°s relevante a gran escala).

Este ejemplo utiliza **PNPM Workspaces** para manejar las dependencias entre paquetes locales de forma eficiente y **Turborepo** para orquestar tareas (build, test, lint) y aplicar un cacheo muy efectivo, acelerando significativamente los flujos de trabajo.

## Objetivo üéØ

* Mostrar una **estructura de monorepo funcional y escalable** usando herramientas modernas.
* Demostrar c√≥mo gestionar **m√∫ltiples paquetes** (frontend, backend, compartido) en un solo lugar.
* Ilustrar el uso de **Turborepo** para optimizar la ejecuci√≥n de tareas y el cacheo.
* Servir como un **punto de partida pr√°ctico** para tus propios proyectos fullstack en monorepo.

## Tecnolog√≠as Clave üõ†Ô∏è

* **Gestor de Monorepo:** [Turborepo](https://turbo.build/repo)
* **Gestor de Paquetes / Workspaces:** [PNPM](https://pnpm.io/)
* **Frontend (`packages/web`):** [React](https://react.dev/), [Vite](https://vitejs.dev/), [TypeScript](https://www.typescriptlang.org/)
* **Backend (`packages/api`):** [Node.js](https://nodejs.org/), [Express](https://expressjs.com/) (o Fastify), [TypeScript](https://www.typescriptlang.org/)
* **Paquete Compartido (`packages/shared-types`):** [TypeScript](https://www.typescriptlang.org/)
* **Calidad de C√≥digo:** ESLint, Prettier (configurados en la ra√≠z y/o por paquete).

## Estructura del Directorio üó∫Ô∏è

* **Ra√≠z:** Contiene la configuraci√≥n global del monorepo y herramientas.
    * `package.json`: Define los `workspaces` (usando PNPM), los scripts globales que usan Turbo (ej: `pnpm dev`), y las dependencias de desarrollo ra√≠z (Turborepo, TypeScript, linters). **Importante:** `private: true` para evitar publicar la ra√≠z en npm.
    * `pnpm-workspace.yaml`: Especifica d√≥nde buscar los paquetes dentro del monorepo (usualmente `packages/*`).
    * `turbo.json`: ¬°El cerebro de Turborepo! Define los `pipelines` (c√≥mo ejecutar tareas como `build`, `dev`, `lint`, `test`), sus dependencias (ej: `build` depende de los `build` de sus dependencias internas y de `^build` que significa las dependencias del paquete), y qu√© artefactos/logs cachear.
    * `tsconfig.base.json`: Configuraci√≥n base de TypeScript que los paquetes pueden extender.
* **`packages/`**: Directorio que contiene cada aplicaci√≥n o librer√≠a individual. Cada subdirectorio es un "paquete" autocontenido con su propio `package.json`, c√≥digo fuente y configuraci√≥n espec√≠fica.
    * **`api/`**: Aplicaci√≥n backend Node.js/Express. Tiene sus propias dependencias y scripts. Puede depender de `shared-types`.
    * **`web/`**: Aplicaci√≥n frontend React/Vite. Tiene sus propias dependencias y scripts. Puede depender de `shared-types` y consumir la `api`.
    * **`shared-types/`**: Ejemplo de librer√≠a compartida. En este caso, solo contiene definiciones de tipos TypeScript. Otros paquetes (`api`, `web`) pueden declararla como dependencia en sus `package.json`.

## C√≥mo Usar esta Plantilla üöÄ

1.  **Prerrequisitos:**
    * Node.js (verifica la versi√≥n recomendada si hay un archivo `.node-version` o `.nvmrc`).
    * PNPM instalado globalmente: `npm install -g pnpm`
2.  **Clonar:** `git clone <URL_DEL_REPO_UNIVERSAL> && cd ejemplos/fullstack-monorepo`
3.  **Instalar Dependencias:** Este comando instalar√° las dependencias para **todos** los paquetes definidos en los workspaces y los enlazar√° localmente.
    ```bash
    pnpm install
    ```
4.  **Variables de Entorno:** Configura los archivos `.env` necesarios dentro de cada paquete que lo requiera (ej: `packages/api/.env`, `packages/web/.env`) bas√°ndote en sus respectivos `.env.example`.
5.  **Ejecutar Servidores de Desarrollo:** Turborepo orquestar√° el inicio de los servidores de `api` y `web` (y cualquier otro paquete con script `dev`).
    ```bash
    # Ejecuta el script 'dev' definido en el package.json ra√≠z,
    # que a su vez usa 'turbo run dev'
    pnpm dev
    ```
    Turborepo ejecutar√° los scripts `dev` definidos en los `package.json` de `api` y `web` en paralelo.
6.  **Construir Todos los Paquetes:** Turborepo construir√° los paquetes en el orden correcto (respetando dependencias) y usar√° el cache si es posible.
    ```bash
    pnpm build
    ```
7.  **Ejecutar Linters/Tests:**
    ```bash
    pnpm lint
    pnpm test
    ```
    Turborepo ejecutar√° los scripts correspondientes en todos los paquetes que los definan.
8.  **Ejecutar Comandos en un Paquete Espec√≠fico:** Usa el flag `--filter` de PNPM (o Turbo).
    ```bash
    # Ejecutar solo el dev server de la API
    pnpm --filter api dev

    # Ejecutar solo los tests del frontend
    pnpm --filter web test

    # Construir solo la librer√≠a compartida y los paquetes que dependen de ella
    pnpm --filter shared-types... build
    ```

## Conceptos Clave del Monorepo Aqu√≠ Implementado üß©

* **Workspaces (PNPM):** PNPM lee `pnpm-workspace.yaml` y el campo `workspaces` en `package.json` para saber d√≥nde est√°n los paquetes. `pnpm install` instala todo y crea symlinks en `node_modules` para que los paquetes puedan importarse entre s√≠ como dependencias normales (ej: `import { User } from 'shared-types';`).
* **Task Orchestration (Turborepo):** Turborepo lee `turbo.json` para entender las dependencias entre tareas (ej: el `build` de `web` depende del `build` de `shared-types`). Ejecuta tareas en paralelo cuando es posible y en el orden correcto.
* **Caching (Turborepo):** Turborepo cachea la salida (`dist/`, `.turbo/`) y los logs de las tareas. Si ejecutas `pnpm build` una segunda vez sin cambios en el c√≥digo fuente de un paquete y sus dependencias, Turborepo restaurar√° la salida desde el cache instant√°neamente (ver√°s `FULL TURBO`). ¬°Esto ahorra much√≠simo tiempo!
* **Shared Packages:** El paquete `shared-types` es un ejemplo. Se construye (compila TS a JS + `.d.ts`) y otros paquetes (`api`, `web`) lo declaran como dependencia en su `package.json` (usando `pnpm add shared-types --filter web`). PNPM se encarga del enlace local.

## Siguientes Pasos y Adaptaci√≥n üë£

* **A√±ade una Base de Datos:** Integra una base de datos en el backend (`api/`) y usa Docker Compose para gestionarla localmente.
* **Implementa Autenticaci√≥n Completa:** A√±ade l√≥gica de autenticaci√≥n en `api` y `web`.
* **Crea m√°s Paquetes:**
    * Una librer√≠a de componentes UI compartida (`packages/ui-library`).
    * Una aplicaci√≥n m√≥vil (React Native, Flutter).
    * Herramientas de scripting (`packages/scripts`).
* **Refina el Pipeline de Turborepo:** Ajusta `turbo.json` para optimizar dependencias entre tareas y estrategias de cacheo.
* **Despliegue:** Configura despliegues independientes para `api` y `web` usando la CI/CD, aprovechando el cache de Turborepo (Remote Caching). Plataformas como Vercel y Netlify tienen integraci√≥n nativa con Turborepo.

## Contribuciones a este Ejemplo ‚ú®

Las sugerencias para mejorar *esta plantilla espec√≠fica de monorepo* son bienvenidas. Sigue la gu√≠a general (`comunidad/como-contribuir.md`) indicando que tu aporte es para `ejemplos/fullstack-monorepo`.

¬°Esperamos que esta plantilla te d√© un impulso inicial fant√°stico para tus proyectos fullstack en monorepo! ¬°Disfruta de la potencia y la organizaci√≥n! üöÄ
``` bash

Okay, ¬°un ejemplo de monorepo fullstack! Este es un patr√≥n cada vez m√°s popular, especialmente en el ecosistema de TypeScript/JavaScript, para gestionar proyectos complejos con m√∫ltiples aplicaciones (frontend, backend, etc.) y librer√≠as compartidas dentro de un √∫nico repositorio.

Para este ejemplo, utilizaremos un enfoque moderno con PNPM Workspaces para la gesti√≥n eficiente de dependencias y Turborepo para la orquestaci√≥n de tareas y el cacheo inteligente de builds/tests. La pila tecnol√≥gica ser√° React (con Vite y TypeScript) para el frontend y Node.js (con Express y TypeScript) para el backend, adem√°s de un paquete compartido.

Asumiendo que este ejemplo pertenece a ejemplos/, proceder√© a generar la estructura y el README para:

ejemplos/fullstack-monorepo/

Av√≠same si prefieres otra ubicaci√≥n.
Estructura Propuesta para ejemplos/fullstack-monorepo/

ejemplos/fullstack-monorepo/
‚îú‚îÄ‚îÄ .gitattributes              # (Opcional) Para normalizar finales de l√≠nea
‚îú‚îÄ‚îÄ .gitignore                  # Ignorar node_modules, dist, .turbo, .env, etc.
‚îú‚îÄ‚îÄ .prettierignore             # (Opcional) Ignorar archivos para Prettier
‚îú‚îÄ‚îÄ .prettierrc.json            # (Opcional) Configuraci√≥n de Prettier en la ra√≠z
‚îú‚îÄ‚îÄ LICENSE
‚îú‚îÄ‚îÄ README.md                   # Este archivo: explicaci√≥n del monorepo
‚îú‚îÄ‚îÄ package.json                # Ra√≠z: Define workspaces, scripts globales, devDeps (turbo, typescript, etc.)
‚îú‚îÄ‚îÄ pnpm-workspace.yaml         # Define la ubicaci√≥n de los paquetes/workspaces
‚îú‚îÄ‚îÄ tsconfig.base.json          # Configuraci√≥n base de TypeScript compartida
‚îî‚îÄ‚îÄ turbo.json                  # Configuraci√≥n de Turborepo (pipelines, cacheo)
‚îî‚îÄ‚îÄ packages/                   # Directorio que contiene todos los paquetes/apps
    ‚îú‚îÄ‚îÄ api/                    # Paquete del Backend (Node.js/Express/TypeScript)
    ‚îÇ   ‚îú‚îÄ‚îÄ .env.example
    ‚îÇ   ‚îú‚îÄ‚îÄ package.json        # Dependencias (express), scripts (dev, build, start)
    ‚îÇ   ‚îú‚îÄ‚îÄ src/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts        # Punto de entrada del servidor
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/
    ‚îÇ   ‚îî‚îÄ‚îÄ tsconfig.json       # Extiende tsconfig.base.json
    ‚îú‚îÄ‚îÄ shared-types/           # Paquete compartido (ej: tipos TypeScript)
    ‚îÇ   ‚îú‚îÄ‚îÄ package.json        # M√≠nimo, define 'main' y 'types'
    ‚îÇ   ‚îú‚îÄ‚îÄ src/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts        # Exporta todo
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.ts
    ‚îÇ   ‚îî‚îÄ‚îÄ tsconfig.json       # Extiende tsconfig.base.json, config de build .d.ts
    ‚îî‚îÄ‚îÄ web/                    # Paquete del Frontend (React/Vite/TypeScript)
        ‚îú‚îÄ‚îÄ .env.example
        ‚îú‚îÄ‚îÄ index.html
        ‚îú‚îÄ‚îÄ package.json        # Dependencias (react), scripts (dev, build, preview)
        ‚îú‚îÄ‚îÄ public/
        ‚îú‚îÄ‚îÄ src/                # Similar al ejemplo frontend-react standalone
        ‚îÇ   ‚îú‚îÄ‚îÄ main.tsx
        ‚îÇ   ‚îú‚îÄ‚îÄ App.tsx
        ‚îÇ   ‚îú‚îÄ‚îÄ components/
        ‚îÇ   ‚îú‚îÄ‚îÄ hooks/
        ‚îÇ   ‚îú‚îÄ‚îÄ pages/
        ‚îÇ   ‚îî‚îÄ‚îÄ services/       # Importa tipos desde 'shared-types'
        ‚îú‚îÄ‚îÄ tsconfig.json       # Extiende tsconfig.base.json
        ‚îî‚îÄ‚îÄ vite.config.ts
```
